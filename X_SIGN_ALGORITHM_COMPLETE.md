# –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ x-sign - –ü–û–ß–¢–ò –ü–û–õ–ù–´–ô

## ‚úÖ –ù–∞–π–¥–µ–Ω–æ:

### 1. –§—É–Ω–∫—Ü–∏—è `ei(J)` - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```javascript
function ei(S) {
    return new en().update(S).digest((0, U.ms)())
}
```
**–ù–û:** –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏, —á—Ç–æ —Ç–∞–∫–æ–µ `en` - —ç—Ç–æ –∫–ª–∞—Å—Å —Ö–µ—à–∞ (MD5 –∏–ª–∏ SHA-256?)

### 2. –§—É–Ω–∫—Ü–∏—è `ep(T)` - –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚úÖ
```javascript
function ep(S) {
    return encodeURIComponent(S)
        .replace(/'/g, "%27")
        .replace(/%3A/gi, ":")
        .replace(/%24/g, "$")
        .replace(/%2C/gi, ",")
        .replace(/%20/g, "+")
        .replace(/%5B/gi, "[")
        .replace(/%5D/gi, "]")
}
```

### 3. –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–º–µ–Ω –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ ‚úÖ
```javascript
let ea = S => N.cg[S - 10] + N.cg[S - 9] + N.cg[S - 8] + N.cg[S - 7] + N.cg[S - 6] + N.cg[S - 5]
let eo = S => N.cg[S - 101] + N.cg[S - 100] + N.cg[S - 91] + N.cg[S - 90]
let ec = S => N.Em[2] + N.Em[3]  // x-appid
let eu = S => N.a7[7] + N.Em[0] + N.Em[1]  // —á—Ç–æ-—Ç–æ –¥–ª—è X((0, U.$i)())
```

### 4. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏ –º–∞—Å—Å–∏–≤ ‚úÖ
```javascript
let ed = /https?:\/\/[^/]+/  // –¥–ª—è –∑–∞–º–µ–Ω—ã –¥–æ–º–µ–Ω–∞
let ef = ["/api/", "/btc-api/", "/fractal-api/"]  // –ø—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
```

### 5. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚úÖ
```javascript
let e_ = "@#?.#@"
```

### 6. –§—É–Ω–∫—Ü–∏—è Z(S) - –¥–ª—è cf-token ‚úÖ
```javascript
function Z(S) {
    let O = S.headers["X-Sign"];
    S.headers["cf-token"] = "".concat(Math.random().toString(36).slice(-6))
        .concat(O.substring(12, 14))
        .concat(Math.random().toString(36).slice(-8), "u")
        .concat(Math.random().toString(36).slice(-8))
}
```

## ‚ùì –û—Å—Ç–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏:

### 1. `en` - –∫–ª–∞—Å—Å —Ö–µ—à–∞
**–ü–æ–∏—Å–∫:** `const en =` –∏–ª–∏ `import en from` –∏–ª–∏ `en = MD5` –∏–ª–∏ `en = SHA256`

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- `const en = require('crypto-js/md5')`
- `const en = require('crypto-js/sha256')`
- `import en from 'crypto-js/md5'`
- `import en from 'crypto-js/sha256'`

### 2. `X((0, U.$i)())` - —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç?
**–ü–æ–∏—Å–∫:** `function X` –∏–ª–∏ `const X =` –∏–ª–∏ `U.$i`

**–ò–∑ –∫–æ–¥–∞ –≤–∏–¥–Ω–æ:**
```javascript
J += "\n" + I + e_ + X((0, U.$i)());
```

–ì–¥–µ:
- `I` = timestamp
- `e_` = "@#?.#@"
- `X((0, U.$i)())` = —á—Ç–æ-—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ "@#?.#@"

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- `X` –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ—É–Ω–∫—Ü–∏–µ–π `eu` (–∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á—Ç–æ-—Ç–æ –∏–∑ `N.a7[7] + N.Em[0] + N.Em[1]`)
- `U.$i()` –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É, –∏–ª–∏ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ

## üìã –ß—Ç–æ –∏—Å–∫–∞—Ç—å –¥–∞–ª—å—à–µ:

1. **–í —Ñ–∞–π–ª–µ `app-2637cbcbd7da64c9.js` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ (Ctrl+F):**
   - `const en =` –∏–ª–∏ `import en` –∏–ª–∏ `en = MD5` –∏–ª–∏ `en = SHA256`
   - `function X` –∏–ª–∏ `const X =`
   - `U.$i` –∏–ª–∏ `U["$i"]`

2. **–ò–ª–∏ –ø–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É:**
   - `crypto-js` - –Ω–∞–π–¥–µ—Ç –∏–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
   - `MD5` - –Ω–∞–π–¥–µ—Ç –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MD5
   - `SHA256` - –Ω–∞–π–¥–µ—Ç –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SHA-256

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ worker.js:

–£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `generateXSign`, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ —Ç–∏–ø —Ö–µ—à–∞ (MD5 –∏–ª–∏ SHA-256)?
2. –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ `@#?.#@`?

