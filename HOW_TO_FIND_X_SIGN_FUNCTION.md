# Как найти функцию генерации x-sign

## Что такое Call Stack?

**Call Stack (стек вызовов)** - это список функций, которые были вызваны перед тем, как выполнился текущий код. Это как "хлебные крошки" - показывает путь от начала до текущей точки.

## Что делать дальше:

### Шаг 1: Найдите сообщение "✅ НАЙДЕН ЗАПРОС С X-SIGN"

В консоли вы увидите что-то вроде:
```
✅ НАЙДЕН ЗАПРОС С X-SIGN (fetch)
URL: https://uniscan.cc/fractal-api/...
x-sign: 456cbba050b7560334ce59a863e41408
x-ts: 1765934147
```

### Шаг 2: Найдите стрелку "▶" или "▼" рядом с сообщением

Рядом с сообщением будет стрелка, которая раскрывает **call stack**. Нажмите на неё!

### Шаг 3: Изучите Call Stack

Вы увидите список функций, например:
```
at fetch (simple_x_sign_finder.js:45)
at someFunction (_app-2637cbcbd7da64c9.js:123)
at requestInterceptor (_app-2637cbcbd7da64c9.js:456)  ← ЭТО НАС ИНТЕРЕСУЕТ!
at axios.interceptors.request.use (_app-2637cbcbd7da64c9.js:789)
```

### Шаг 4: Кликните на функцию в Call Stack

**Кликните на функцию**, которая находится **выше** в списке (не на `fetch`, а на функцию **до** него). Обычно это что-то вроде:
- `requestInterceptor`
- `interceptors.request.use`
- `eh` (из вашего кода)
- Любая функция из `_app-2637cbcbd7da64c9.js`

### Шаг 5: Откроется код функции

Когда вы кликнете, откроется вкладка **Sources** с кодом функции. Вы увидите что-то вроде:

```javascript
S.interceptors.request.use(S => {
    let I = Math.floor(Date.now() / 1e3);  // timestamp
    let J = (S.baseURL || "") + S.url;
    // ... код ...
    J += "\n" + I + e_ + X((0, U.$i)());
    S.headers[ea((0, U.tt)())] = ei(J);  // x-sign = ei(J)
    S.headers[eo((0, U.Q9)())] = I;        // x-ts = I
    return S;
});
```

### Шаг 6: Найдите нужные функции

В этом коде найдите:

1. **`X((0, U.$i)())`** - что возвращает эта функция?
   - Найдите определение `U.$i` или `U["$i"]`
   - Найдите определение функции `X`

2. **`ei(J)`** - функция хеширования
   - Найдите определение `ei`
   - Найдите определение `en` (класс хеша - MD5 или SHA-256?)

3. **`ep(T)`** - функция кодирования параметров
   - Найдите определение `ep`

### Шаг 7: Скопируйте код

1. Выделите код функции (Ctrl+A в открытом файле)
2. Скопируйте (Ctrl+C)
3. Отправьте мне

## Альтернативный способ (если call stack не открывается):

1. В консоли найдите строку с `console.trace()`
2. Рядом будет ссылка на файл и номер строки, например: `_app-2637cbcbd7da64c9.js:456`
3. Откройте DevTools → Sources
4. Найдите файл `_app-2637cbcbd7da64c9.js`
5. Перейдите на строку 456 (Ctrl+G, введите 456)
6. Изучите код вокруг этой строки

## Что искать в коде:

### 1. Функция `X((0, U.$i)())`
Ищите:
```javascript
U.$i = function() { return ... }
// или
U["$i"] = function() { return ... }
// или
function X(...) { ... }
```

### 2. Функция `ei(J)` - хеширование
Ищите:
```javascript
function ei(S) {
    return new en().update(S).digest(...);
}
// Найти что такое en:
const en = MD5;  // или
const en = SHA256;  // или
import en from 'crypto-js/md5';
```

### 3. Функция `ep(T)` - кодирование
Ищите:
```javascript
function ep(T) {
    // код кодирования параметров
}
```

## Пример того, что нужно скопировать:

```javascript
// Пример 1: Функция X
U.$i = function() {
    return "";  // или "unisat" или что-то другое
}

// Пример 2: Функция ei (хеширование)
function ei(S) {
    const en = require('crypto-js/md5');
    return new en().update(S).digest('hex').substring(0, 32);
}

// Пример 3: Функция ep (кодирование)
function ep(T) {
    return encodeURIComponent(T)
        .replace(/'/g, "%27")
        .replace(/%3A/gi, ":")
        // ... остальные правила
}
```

## Если ничего не нашли:

1. Убедитесь, что вы кликнули на правильную функцию в call stack (не на `fetch`, а на функцию **до** него)
2. Попробуйте кликнуть на разные функции в call stack
3. Используйте поиск (Ctrl+F) в открытом файле для поиска:
   - `U.$i`
   - `function ei`
   - `new en()`
   - `function ep`
   - `@#?.#@`

