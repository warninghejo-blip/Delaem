<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ x-sign –∞–ª–≥–æ—Ä–∏—Ç–º–∞</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #4ec9b0;
        }
        h2 {
            color: #569cd6;
            margin-top: 30px;
        }
        .code-block {
            background: #252526;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #007acc;
            margin: 15px 0;
            overflow-x: auto;
        }
        .code-block code {
            color: #ce9178;
        }
        .step {
            background: #2d2d30;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #4ec9b0;
        }
        .warning {
            background: #3f3f00;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 3px solid #ffd700;
        }
        .success {
            background: #0f3f0f;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 3px solid #4ec9b0;
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #005a9e;
        }
        #results {
            margin-top: 20px;
        }
        .result-item {
            background: #252526;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ x-sign</h1>

        <div class="warning">
            <strong>‚ö†Ô∏è –í–ê–ñ–ù–û:</strong> –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ <strong>uniscan.cc</strong> –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞!
        </div>

        <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h2>

        <div class="step">
            <strong>–®–∞–≥ 1:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç <a href="https://uniscan.cc" target="_blank" style="color: #4ec9b0;">uniscan.cc</a>
        </div>

        <div class="step">
            <strong>–®–∞–≥ 2:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí –≤–∫–ª–∞–¥–∫–∞ <strong>Console</strong>
        </div>

        <div class="step">
            <strong>–®–∞–≥ 3:</strong> –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å:
        </div>

        <div class="code-block">
            <code id="scriptCode">
// –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ x-sign
(function() {
    console.log('üîç –ù–∞—á–∏–Ω–∞—é –ø–æ–∏—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ x-sign...\n');

    let foundRequests = [];

    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º XMLHttpRequest
    const originalXHROpen = XMLHttpRequest.prototype.open;
    const originalXHRSend = XMLHttpRequest.prototype.send;
    const originalXHRSetRequestHeader = XMLHttpRequest.prototype.setRequestHeader;

    const xhrHeaders = {};

    XMLHttpRequest.prototype.open = function(method, url, ...rest) {
        this._url = url;
        this._method = method;
        this._headers = {};
        return originalXHROpen.apply(this, [method, url, ...rest]);
    };

    XMLHttpRequest.prototype.setRequestHeader = function(name, value) {
        if (!this._headers) this._headers = {};
        this._headers[name.toLowerCase()] = value;
        if (name.toLowerCase() === 'x-sign' || name.toLowerCase() === 'x-ts') {
            console.log(`\n‚úÖ –ù–ê–ô–î–ï–ù –ó–ê–ì–û–õ–û–í–û–ö ${name.toUpperCase()}:`, value);
            console.log('   URL:', this._url);
            console.trace();
        }
        return originalXHRSetRequestHeader.apply(this, [name, value]);
    };

    XMLHttpRequest.prototype.send = function(...args) {
        if (this._headers && (this._headers['x-sign'] || this._headers['x-ts'])) {
            console.log('\n‚úÖ –ù–ê–ô–î–ï–ù XHR –ó–ê–ü–†–û–° –° X-SIGN:');
            console.log('   URL:', this._url);
            console.log('   Method:', this._method);
            console.log('   Headers:', this._headers);
            console.trace();
            foundRequests.push({
                type: 'XHR',
                url: this._url,
                method: this._method,
                headers: this._headers
            });
        }
        return originalXHRSend.apply(this, args);
    };

    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º fetch
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        const url = args[0];
        const options = args[1] || {};
        const headers = options.headers || {};

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        const xSign = headers['x-sign'] || headers['X-Sign'] || (headers.get && headers.get('x-sign'));
        const xTs = headers['x-ts'] || headers['X-Ts'] || (headers.get && headers.get('x-ts'));

        if (xSign || xTs) {
            console.log('\n‚úÖ –ù–ê–ô–î–ï–ù FETCH –ó–ê–ü–†–û–° –° X-SIGN:');
            console.log('   URL:', url);
            console.log('   x-sign:', xSign);
            console.log('   x-ts:', xTs);
            console.log('   –í—Å–µ headers:', headers);
            console.trace();
            foundRequests.push({
                type: 'fetch',
                url: url,
                headers: headers
            });
        }

        return originalFetch.apply(this, args);
    };

    // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º axios interceptors
    if (window.axios) {
        console.log('‚úÖ –ù–∞–π–¥–µ–Ω axios, –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é interceptors...');
        try {
            const originalRequest = window.axios.interceptors.request.use;
            window.axios.interceptors.request.use = function(fulfilled, rejected) {
                return originalRequest.call(this, function(config) {
                    if (config.headers) {
                        const xSign = config.headers['x-sign'] || config.headers['X-Sign'];
                        const xTs = config.headers['x-ts'] || config.headers['X-Ts'];
                        if (xSign || xTs) {
                            console.log('\n‚úÖ –ù–ê–ô–î–ï–ù AXIOS –ó–ê–ü–†–û–° –° X-SIGN:');
                            console.log('   URL:', config.url);
                            console.log('   x-sign:', xSign);
                            console.log('   x-ts:', xTs);
                            console.log('   Config:', config);
                            console.trace();
                            foundRequests.push({
                                type: 'axios',
                                url: config.url,
                                headers: config.headers
                            });
                        }
                    }
                    return fulfilled ? fulfilled(config) : config;
                }, rejected);
            };
        } catch (e) {
            console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å axios:', e);
        }
    }

    // –ü–æ–∏—Å–∫ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö
    console.log('\nüì¶ –ò—â—É —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö...');
    const searchInWindow = () => {
        const found = [];
        for (let key in window) {
            try {
                const value = window[key];
                if (typeof value === 'object' && value !== null) {
                    const str = JSON.stringify(value).substring(0, 1000);
                    if (str.includes('x-sign') || str.includes('x-ts') ||
                        str.includes('U.$i') || str.includes('function X') ||
                        str.includes('function ei') || str.includes('new en()')) {
                        found.push(key);
                    }
                }
            } catch (e) {}
        }
        return found;
    };

    const windowResults = searchInWindow();
    if (windowResults.length > 0) {
        console.log('‚úÖ –ù–∞–π–¥–µ–Ω—ã –æ–±—ä–µ–∫—Ç—ã –≤ window:', windowResults);
    }

    console.log('\n‚úÖ –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! –¢–µ–ø–µ—Ä—å:');
    console.log('1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å');
    console.log('2. –ö–æ–≥–¥–∞ —É–≤–∏–¥–∏—Ç–µ "–ù–ê–ô–î–ï–ù", –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–µ–ª–∫—É –≤ call stack');
    console.log('3. –ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç x-sign');
    console.log('4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ');
    console.log('\nüìã –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ window._foundXSignRequests\n');

    window._foundXSignRequests = foundRequests;
    window._xSignInterceptor = {
        getRequests: () => foundRequests,
        clear: () => foundRequests = []
    };

    return '–°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞.';
})();
            </code>
        </div>

        <div class="step">
            <strong>–®–∞–≥ 4:</strong> –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥:
        </div>

        <button onclick="copyCode()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞</button>

        <div class="success">
            <strong>‚úÖ –ü–æ—Å–ª–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:</strong>
            <ol>
                <li>–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ uniscan.cc</li>
                <li>–ù–∞–∂–º–∏—Ç–µ Enter</li>
                <li>–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ —Å–¥–µ–ª–∞–π—Ç–µ –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å</li>
                <li>–ö–æ–≥–¥–∞ —É–≤–∏–¥–∏—Ç–µ "–ù–ê–ô–î–ï–ù –ó–ê–ü–†–û–° –° X-SIGN", –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–µ–ª–∫—É –≤ call stack</li>
                <li>–ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç x-sign</li>
                <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ</li>
            </ol>
        </div>

        <h2>üéØ –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –∫–æ–¥–µ:</h2>

        <div class="result-item">
            <strong>1. X((0, U.$i)())</strong> - —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è?
            <div class="code-block">
                <code>// –ò—â–∏—Ç–µ: U.$i –∏–ª–∏ U["$i"] –∏–ª–∏ function X</code>
            </div>
        </div>

        <div class="result-item">
            <strong>2. ei(J)</strong> - MD5 –∏–ª–∏ SHA-256?
            <div class="code-block">
                <code>// –ò—â–∏—Ç–µ: function ei –∏–ª–∏ new en() –∏–ª–∏ MD5 –∏–ª–∏ SHA256</code>
            </div>
        </div>

        <div class="result-item">
            <strong>3. ep(T)</strong> - –≤—Å–µ –ª–∏ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —É—á—Ç–µ–Ω—ã?
            <div class="code-block">
                <code>// –ò—â–∏—Ç–µ: function ep</code>
            </div>
        </div>

        <div id="results"></div>
    </div>

    <script>
        function copyCode() {
            const code = document.getElementById('scriptCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('‚úÖ –ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }).catch(err => {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textarea = document.createElement('textarea');
                textarea.value = code;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('‚úÖ –ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            });
        }
    </script>
</body>
</html>

