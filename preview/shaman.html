<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Fennec ID • SHAMAN • Evolution Preview</title>
        <link rel="stylesheet" href="./_shared.css" />
        <style>
            html,
            body {
                overflow: auto;
                height: auto;
            }
            .grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
                gap: 16px;
                align-items: start;
            }
            .tile .card-host {
                display: flex;
                justify-content: center;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="topbar">
                <div class="title">SHAMAN</div>
                <div class="nav">
                    <a href="./index.html">INDEX</a>
                    <a href="./drifter.html">DRIFTER</a>
                    <a href="./walker.html">WALKER</a>
                    <a href="./merchant.html">MERCHANT</a>
                    <a href="./engineer.html">ENGINEER</a>
                    <a href="./shaman.html">SHAMAN</a>
                    <a href="./keeper.html">KEEPER</a>
                    <a href="./lord.html">LORD</a>
                    <a href="./prime.html">PRIME</a>
                    <a href="./singularity.html">SINGULARITY</a>
                </div>
            </div>

            <p class="subtitle">Live-render Tier 0 → Tier 3 (generated via <code>FennecIDLib.createCard()</code>).</p>

            <div class="grid" id="grid"></div>

            <div class="footer">Tip: hover for tilt, click to flip.</div>
        </div>

        <script>
            (function () {
                const path = (location.pathname || '').toLowerCase();
                document.querySelectorAll('.nav a').forEach(a => {
                    const href = (a.getAttribute('href') || '').toLowerCase();
                    if (href && path.endsWith(href.replace('./', '/'))) a.classList.add('active');
                });
            })();
        </script>

        <script src="../recursive_inscriptions/fennec_lib_v2.js"></script>
        <script>
            (function () {
                const BADGES = [
                    'GENESIS',
                    'WHALE',
                    'PROVIDER',
                    'FENNEC MAXI',
                    'ARTIFACT HUNTER',
                    'RUNE KEEPER',
                    'MEMPOOL RIDER',
                    'SAND SWEEPER'
                ];

                function fixPage() {
                    try {
                        document.documentElement.style.setProperty('overflow', 'auto', 'important');
                        document.body.style.setProperty('overflow', 'auto', 'important');
                        document.documentElement.style.setProperty('height', 'auto', 'important');
                        document.body.style.setProperty('height', 'auto', 'important');
                        document.documentElement.style.setProperty('background', '#050505', 'important');
                        document.body.style.setProperty('background', '#050505', 'important');
                    } catch (_) {}
                }

                function tierBadges(tier) {
                    if (tier === 0) return [];
                    if (tier === 1) return BADGES.slice(0, 2);
                    if (tier === 2) return BADGES.slice(0, 4);
                    return BADGES.slice(0, 6);
                }

                function makeDna(baseKey, tier) {
                    return {
                        inscriptionNumber: `${baseKey} • T${tier}`,
                        archetype: { baseKey, title: baseKey },
                        badges: tierBadges(tier),
                        metrics: {
                            activityScore: 55,
                            daysAlive: 478,
                            txCount: 12988,
                            netWorthUSD: 123.45,
                            lpValueUSD: 157,
                            inscriptionStats: {
                                runes: 7,
                                brc20: 5,
                                ordinals: 99,
                                totalCollections: 42
                            }
                        }
                    };
                }

                async function init() {
                    const root = document.getElementById('grid');
                    if (!root) return;

                    const lib = window.FennecIDLib;
                    if (!lib || typeof lib.createCard !== 'function') {
                        root.innerHTML = '<div class="subtitle">FennecIDLib not available.</div>';
                        return;
                    }

                    let config = null;
                    try {
                        config = typeof lib.loadConfig === 'function' ? await lib.loadConfig() : null;
                    } catch (_) {}

                    const baseKey = 'SHAMAN';
                    for (let tier = 0; tier <= 3; tier++) {
                        const tile = document.createElement('div');
                        tile.className = 'tile';
                        tile.innerHTML = `
                            <div class="tile-head">
                                <div class="tier-name">Tier ${tier}</div>
                                <div class="tier-note">Badges: ${tierBadges(tier).length}</div>
                            </div>
                            <div class="card-host"></div>
                        `;
                        const host = tile.querySelector('.card-host');
                        host.appendChild(lib.createCard(makeDna(baseKey, tier), config || undefined));
                        root.appendChild(tile);
                    }

                    fixPage();
                }

                if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
                else init();
            })();
        </script>
    </body>
</html>
