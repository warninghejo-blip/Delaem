<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Fennec ID â€¢ Rarity Frames Preview</title>
        <link rel="stylesheet" href="./_shared.css" />
        <style>
            .grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
                gap: 16px;
                align-items: start;
            }
            .tile .card-host {
                display: flex;
                justify-content: center;
            }
            .tile .card-host > .card-scene {
                transform: none;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="topbar">
                <div class="title">Rarity Frames</div>
                <div class="nav">
                    <a href="./index.html">INDEX</a>
                    <a href="./rarities.html">RARITIES</a>
                    <a href="./all.html">ALL</a>
                    <a href="./drifter.html">DRIFTER</a>
                    <a href="./walker.html">WALKER</a>
                    <a href="./merchant.html">MERCHANT</a>
                    <a href="./engineer.html">ENGINEER</a>
                    <a href="./shaman.html">SHAMAN</a>
                    <a href="./keeper.html">KEEPER</a>
                    <a href="./lord.html">LORD</a>
                    <a href="./prime.html">PRIME</a>
                    <a href="./singularity.html">SINGULARITY</a>
                </div>
            </div>

            <p class="subtitle">Frame comparison preview. Click a card to flip. Hover to tilt.</p>

            <div class="grid" id="grid"></div>

            <div class="footer">Tip: compare corner clipping while tilting and flipping each rarity.</div>
        </div>

        <script>
            (function () {
                const path = (location.pathname || '').toLowerCase();
                document.querySelectorAll('.nav a').forEach(a => {
                    const href = (a.getAttribute('href') || '').toLowerCase();
                    if (href && path.endsWith(href.replace('./', '/'))) a.classList.add('active');
                });
            })();
        </script>

        <script src="../recursive_inscriptions/fennec_lib_v2.js"></script>
        <script>
            (function () {
                const RARITIES = [
                    { name: 'CUB', score: 10 },
                    { name: 'SCOUT', score: 35 },
                    { name: 'HUNTER', score: 55 },
                    { name: 'ALPHA', score: 70 },
                    { name: 'ELDER', score: 85 },
                    { name: 'SPIRIT', score: 97 }
                ];

                function makeDna(label, score) {
                    return {
                        inscriptionNumber: label,
                        archetype: { baseKey: 'DRIFTER', title: 'DRIFTER' },
                        badges: [],
                        metrics: {
                            activityScore: score,
                            daysAlive: 120,
                            txCount: 420,
                            netWorthUSD: 123.45,
                            lpValueUSD: 12.34,
                            inscriptionStats: {
                                runes: 7,
                                brc20: 5,
                                ordinals: 99,
                                totalCollections: 42,
                                lp: 1
                            }
                        }
                    };
                }

                async function init() {
                    const root = document.getElementById('grid');
                    if (!root) return;

                    const lib = window.FennecIDLib;
                    if (!lib || typeof lib.createCard !== 'function') {
                        root.innerHTML = '<div class="subtitle">FennecIDLib not available.</div>';
                        return;
                    }

                    let config = null;
                    try {
                        config = typeof lib.loadConfig === 'function' ? await lib.loadConfig() : null;
                    } catch (_) {}

                    RARITIES.forEach(r => {
                        const tile = document.createElement('div');
                        tile.className = 'tile';
                        tile.innerHTML = `
                            <div class="tile-head">
                                <div class="tier-name">${r.name}</div>
                                <div class="tier-note">Score ${r.score}</div>
                            </div>
                            <div class="card-host"></div>
                        `;

                        const host = tile.querySelector('.card-host');
                        const scene = lib.createCard(makeDna(r.name, r.score), config || undefined);
                        host.appendChild(scene);
                        root.appendChild(tile);
                    });
                }

                if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
                else init();
            })();
        </script>
    </body>
</html>
